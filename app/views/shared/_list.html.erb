
<% if @assets.length > 0 or @folders.length > 0 or current_user.has_shared_folders_from_others? %>

    <table cellspacing=0>
	
      <tr bgcolor=#EEEEE>
	    <td colspan=2></td>
        <td>Nom</td>
        <td>Mise en ligne le</td>
        <td>Taille</td>
        <td></td>
      </tr>
      <% if !@current_folder %>
        <% @shared_folders_by_others.each do |f|%>
            <tr bgcolor=#EEEEEE>
            <td colspan=2>Propriétaire:<br><%= User.find_by_id(f.user_id).email %></td>
            <td><div class="folder_shared_by_others"><%= link_to f.name, folder_path(f) %></div></td>
            <td><%= f.updated_at %></td>
            <td></td>
            <td></td>
        <% end %>
      <% end %>
	  <% @folders.each do |f|%>
        <% if current_user.has_ownership?(f) %>
            <tr>
            <td><%= link_to 'Supprimer', folder_path(f), method: :delete, data: {confirm: 'Etes vous sûr ?' } %></td>
            <td>
            <%= link_to 'Partager', new_share_on_folder_path(f) %>
            </td>
            <td><div class="folder<%= f.shared? ? '_shared' : '' %>"><%= link_to f.name, folder_path(f) %>
            <% if f.shared? %>
                <%= link_to '[Cesser de partager]', shared_folder_path(f), method: :delete, data: {confirm: 'confirmez-vous cette cessation de partage?'} %>
                <%= link_to '[Voir les partages]', shared_folder_path(f) %>
            <% end %>
            </div></td>
            
        <% else %>
            <% if current_user.has_shared_access?(f) %>
                <tr bgcolor=#EEEEEE>
                <td colspan=2>Propriétaire:<br><%= User.find_by_id(f.user_id).email %></td>
                <td><div class="folder_sub_shared_by_others"><%= link_to f.name, folder_path(f) %></div></td>
            <% end %>
        <% end %>
        <td><%= f.updated_at %></td>
        <td></td>
        <td></td>
        </tr>    
      <% end %>
	
      <% @assets.each do |f|%>
        <% if current_user.has_asset_ownership?(f) %>
            <tr>
            <td><%= link_to 'Supprimer', asset_path(f), method: :delete, data: {confirm: 'Etes vous sûr ?' } %></td>
            <td></td>
            <td><div class="file"><%= link_to f.uploaded_file_file_name, download_url(f) %></div></td>
        <% else %>
            <tr bgcolor=#EEEEEE>
            <td colspan=2>Propriétaire:<br><%= User.find_by_id(f.user_id).email %></td>
            <td><div class="file_shared"><%= link_to f.uploaded_file_file_name, download_url(f) %></div></td>
        <% end %>
        <!-- we could do f.uploaded_file_updated_at.strftime("%d/%m/%Y %l:%M%p") 
            but we have done it directly in /config/environnement so we don't have to repeat it in the views -->
        <td><%= f.uploaded_file_updated_at %></td>
        <td><%= number_to_human_size(f.uploaded_file_file_size, :precision => 2) %></td>
        <td><%#= link_to f.uploaded_file_file_name, f.uploaded_file.url %></td>
        </tr>
      <% end %>
	  
    </table>
<% end %>
